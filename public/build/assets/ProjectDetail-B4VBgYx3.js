import{r as x,u as j,j as e,H as S,L as I}from"./app-B7W7oclS.js";import{B as M}from"./BendaharaLayout-DtlQTwzt.js";import{P as F}from"./PageHeader-DAIkh9h2.js";import{M as g}from"./Modal-BdkaDH1m.js";import{T as n}from"./TextInput-4JNY-dzr.js";import{I as s}from"./InputLabel-BpLXTgxG.js";import{P as y}from"./PrimaryButton-D8BSPuzh.js";import{S as v}from"./SecondaryButton-DUSan6yH.js";import{A as P}from"./arrow-left-o4JRIdcw.js";import{c as i}from"./createLucideIcon-fLso-elW.js";import{H as T}from"./history-BHXaxsYn.js";/* empty css            */import"./ApplicationLogo-Cn1AfSU7.js";import"./transition-C5nqvWym.js";import"./with-selector-DfM91umw.js";const B=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],L=i("circle-check",B);const O=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],$=i("clock",O);const z=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],N=i("credit-card",z);const H=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],K=i("file-down",H);const V=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],q=i("file-spreadsheet",V);const A=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],R=i("plus",A);const E=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],J=i("receipt",E);function re({project:d,unbilled_shipments:h,billed_shipments:p,payments:u}){const[r,f]=x.useState("unbilled"),[b,o]=x.useState(!1),[_,c]=x.useState(!1),l=j({amount:"",date:new Date().toISOString().split("T")[0],description:"Pembayaran Piutang",notes:""}),t=j({start_date:"",end_date:new Date().toISOString().split("T")[0],invoice_date:new Date().toISOString().split("T")[0],mark_as_billed:!0,doc_no:"",delivery_note:"",po_so_no:"",terms_of_payment:"",due_date_jt:""}),m=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(a),k=a=>{a.preventDefault(),d?.id&&l.post(route("receivable.project.payment.store",d.id),{onSuccess:()=>{o(!1),l.reset()}})},w=a=>{if(a.preventDefault(),!d?.id)return;const C=route("receivable.project.export-invoice",{project:d.id,...t.data});window.open(C,"_blank"),c(!1)},D=[{id:"unbilled",label:"Belum Ditagih",icon:$},{id:"history",label:"Riwayat Tagihan",icon:T},{id:"payments",label:"Pembayaran",icon:N}];return e.jsxs(M,{children:[e.jsx(S,{title:`Transaksi ${d.name}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(I,{href:d.customer_id?route("receivable.customer.show",d.customer_id):"#",className:"inline-flex items-center text-sm font-medium text-slate-500 hover:text-slate-900 transition-colors",children:[e.jsx(P,{className:"mr-1 w-4 h-4"}),"Kembali ke Daftar Proyek"]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4",children:[e.jsx(F,{title:d.name,subtitle:`${d.customer.name} - ${d.location||"No Location"}`,icon:q}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>o(!0),className:"bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2.5 rounded-xl text-sm font-bold flex items-center transition-all shadow-sm",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Input Pembayaran"]}),e.jsxs("button",{onClick:()=>c(!0),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2.5 rounded-xl text-sm font-bold flex items-center transition-all shadow-sm",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Buat Invoice"]})]})]}),e.jsx("div",{className:"flex border-b border-slate-200 gap-8",children:D.map(a=>e.jsxs("button",{onClick:()=>f(a.id),className:`pb-4 text-sm font-bold flex items-center gap-2 transition-all relative ${r===a.id?"text-indigo-600":"text-slate-500 hover:text-slate-700"}`,children:[e.jsx(a.icon,{className:"w-4 h-4"}),a.label,r===a.id&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-600 rounded-full"})]},a.id))}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden",children:[r==="unbilled"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50/50 text-slate-500 text-xs font-bold uppercase tracking-wider",children:[e.jsx("th",{className:"px-6 py-4",children:"Tanggal"}),e.jsx("th",{className:"px-6 py-4",children:"No. Docket (DN)"}),e.jsx("th",{className:"px-6 py-4",children:"Mutu"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Volume"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Harga Satuan"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Total"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:h.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-slate-500 italic",children:"Semua pengiriman sudah ditagih."})}):h.map(a=>e.jsxs("tr",{className:"text-sm",children:[e.jsx("td",{className:"px-6 py-4",children:new Date(a.date).toLocaleDateString("id-ID")}),e.jsx("td",{className:"px-6 py-4 font-mono font-bold text-indigo-600",children:a.docket_number}),e.jsx("td",{className:"px-6 py-4",children:a.concrete_grade?.code||"-"}),e.jsxs("td",{className:"px-6 py-4 text-center",children:[a.volume," M3"]}),e.jsx("td",{className:"px-6 py-4 text-right",children:m(a.price_per_m3)}),e.jsx("td",{className:"px-6 py-4 text-right font-bold",children:m(a.total_price)})]},a.id))})]})}),r==="history"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50/50 text-slate-500 text-xs font-bold uppercase tracking-wider",children:[e.jsx("th",{className:"px-6 py-4",children:"Tanggal"}),e.jsx("th",{className:"px-6 py-4",children:"No. Docket (DN)"}),e.jsx("th",{className:"px-6 py-4",children:"Mutu"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Volume"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Total"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:p.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-slate-500 italic",children:"Belum ada riwayat tagihan."})}):p.map(a=>e.jsxs("tr",{className:"text-sm",children:[e.jsx("td",{className:"px-6 py-4",children:new Date(a.date).toLocaleDateString("id-ID")}),e.jsx("td",{className:"px-6 py-4 font-mono font-bold text-slate-600",children:a.docket_number}),e.jsx("td",{className:"px-6 py-4",children:a.concrete_grade?.code||"-"}),e.jsxs("td",{className:"px-6 py-4 text-center",children:[a.volume," M3"]}),e.jsx("td",{className:"px-6 py-4 text-right",children:m(a.total_price)}),e.jsx("td",{className:"px-6 py-4 text-center text-emerald-600 font-bold",children:e.jsxs("span",{className:"inline-flex items-center",children:[e.jsx(L,{className:"w-4 h-4 mr-1"})," Billed"]})})]},a.id))})]})}),r==="payments"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50/50 text-slate-500 text-xs font-bold uppercase tracking-wider",children:[e.jsx("th",{className:"px-6 py-4",children:"Tanggal"}),e.jsx("th",{className:"px-6 py-4",children:"Keterangan"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Jumlah Pembayaran"}),e.jsx("th",{className:"px-6 py-4",children:"Catatan"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:u.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-6 py-12 text-center text-slate-500 italic",children:"Belum ada transaksi pembayaran."})}):u.map(a=>e.jsxs("tr",{className:"text-sm",children:[e.jsx("td",{className:"px-6 py-4",children:new Date(a.date).toLocaleDateString("id-ID")}),e.jsx("td",{className:"px-6 py-4 font-bold",children:a.description}),e.jsx("td",{className:"px-6 py-4 text-right text-emerald-600 font-bold",children:m(a.amount)}),e.jsx("td",{className:"px-6 py-4 text-slate-500",children:a.notes||"-"})]},a.id))})]})})]})]}),e.jsx(g,{show:b,onClose:()=>o(!1),maxWidth:"md",children:e.jsxs("form",{onSubmit:k,className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-900 mb-6 flex items-center",children:[e.jsx(N,{className:"w-6 h-6 mr-2 text-emerald-600"}),"Input Pembayaran Baru"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"amount",value:"Jumlah Pembayaran (Rp)"}),e.jsx(n,{id:"amount",type:"number",className:"mt-1 block w-full",value:l.data.amount,onChange:a=>l.setData("amount",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"date",value:"Tanggal Transaksi"}),e.jsx(n,{id:"date",type:"date",className:"mt-1 block w-full",value:l.data.date,onChange:a=>l.setData("date",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"description",value:"Keterangan"}),e.jsx(n,{id:"description",className:"mt-1 block w-full",value:l.data.description,onChange:a=>l.setData("description",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"notes",value:"Catatan Tambahan (Opsional)"}),e.jsx("textarea",{id:"notes",className:"mt-1 block w-full border-slate-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",rows:"3",value:l.data.notes,onChange:a=>l.setData("notes",a.target.value)})]})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-3",children:[e.jsx(v,{onClick:()=>o(!1),children:"Batal"}),e.jsx(y,{disabled:l.processing,className:"bg-emerald-600 hover:bg-emerald-700",children:"Simpan Pembayaran"})]})]})}),e.jsx(g,{show:_,onClose:()=>c(!1),maxWidth:"md",children:e.jsxs("form",{onSubmit:w,className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-900 mb-6 flex items-center",children:[e.jsx(K,{className:"w-6 h-6 mr-2 text-indigo-600"}),"Generate Invoice PDF"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"start_date",value:"Dari Tanggal (DN)"}),e.jsx(n,{id:"start_date",type:"date",className:"mt-1 block w-full",value:t.data.start_date,onChange:a=>t.setData("start_date",a.target.value)}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-1",children:"* Kosongkan untuk semua"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"end_date",value:"Sampai Tanggal (DN)"}),e.jsx(n,{id:"end_date",type:"date",className:"mt-1 block w-full",value:t.data.end_date,onChange:a=>t.setData("end_date",a.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"invoice_date",value:"Tanggal Invoice (Di Cetakan)"}),e.jsx(n,{id:"invoice_date",type:"date",className:"mt-1 block w-full",value:t.data.invoice_date,onChange:a=>t.setData("invoice_date",a.target.value),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"doc_no",value:"Doc. No."}),e.jsx(n,{id:"doc_no",className:"mt-1 block w-full",value:t.data.doc_no,onChange:a=>t.setData("doc_no",a.target.value),placeholder:"INV/JKK/..."})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"delivery_note",value:"Delivery Note/Date"}),e.jsx(n,{id:"delivery_note",className:"mt-1 block w-full",value:t.data.delivery_note,onChange:a=>t.setData("delivery_note",a.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"po_so_no",value:"PO atau SO No./Date"}),e.jsx(n,{id:"po_so_no",className:"mt-1 block w-full",value:t.data.po_so_no,onChange:a=>t.setData("po_so_no",a.target.value)})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"terms_of_payment",value:"Terms of Payment"}),e.jsx(n,{id:"terms_of_payment",className:"mt-1 block w-full",value:t.data.terms_of_payment,onChange:a=>t.setData("terms_of_payment",a.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"due_date_jt",value:"Due Date / JT"}),e.jsx(n,{id:"due_date_jt",className:"mt-1 block w-full",value:t.data.due_date_jt,onChange:a=>t.setData("due_date_jt",a.target.value)})]}),e.jsxs("div",{className:"flex items-center mt-4",children:[e.jsx("input",{type:"checkbox",id:"mark_as_billed",className:"rounded border-slate-300 text-indigo-600 shadow-sm focus:ring-indigo-500",checked:t.data.mark_as_billed,onChange:a=>t.setData("mark_as_billed",a.target.checked)}),e.jsx("label",{htmlFor:"mark_as_billed",className:"ml-2 text-sm text-slate-700 font-medium",children:'Tandai pengiriman sebagai "Sudah Ditagih"'})]})]}),e.jsx("p",{className:"mt-6 text-xs text-slate-500 bg-slate-50 p-3 rounded-lg border border-slate-100",children:"* Export ini akan mencakup pengiriman dalam periode yang dipilih dan otomatis menghitung total DP/pembayaran yang telah masuk hingga tanggal invoice."}),e.jsxs("div",{className:"mt-8 flex justify-end gap-3",children:[e.jsx(v,{onClick:()=>c(!1),children:"Batal"}),e.jsx(y,{className:"bg-indigo-600 hover:bg-indigo-700",children:"Unduh PDF Invoice"})]})]})})]})}export{re as default};
