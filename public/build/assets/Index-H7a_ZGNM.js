import{r as i,c as b,j as e,H as v,L as g}from"./app-BSO6VoEY.js";import{B as w}from"./BendaharaLayout-Dwfci_0C.js";import{T as k}from"./TextInput-CoZdqjkH.js";import{M as S}from"./Modal-DQ2V8Qyo.js";import{S as _}from"./SecondaryButton-CXZF56LC.js";/* empty css            */import"./ApplicationLogo-CQFnm9YQ.js";import"./transition-DVa4_xZq.js";import"./with-selector-De32bdd_.js";function P({logs:d,filters:n}){const[l,j]=i.useState(n.search||""),[s,x]=i.useState(null),[y,c]=i.useState(!1);i.useEffect(()=>{const t=setTimeout(()=>{l!==(n.search||"")&&b.get(route("superadmin.activity_logs.index"),{search:l},{preserveState:!0,replace:!0})},500);return()=>clearTimeout(t)},[l]);const f=t=>{x(t),c(!0)},m=()=>{c(!1),x(null)},N=t=>{if(!t)return e.jsx("p",{className:"text-gray-500",children:"Tidak ada detail perubahan."});if(t.old||t.attributes){const a=t.old||{},h=t.attributes||{},u=[...new Set([...Object.keys(a),...Object.keys(h)])].filter(r=>r!=="ip"&&r!=="user_agent");return u.length===0?e.jsx("p",{className:"text-gray-500",children:"Tidak ada atribut yang berubah."}):e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Field"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Lama"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Baru"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 text-sm",children:u.map(r=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 font-medium text-gray-700",children:r}),e.jsx("td",{className:"px-4 py-2 text-red-600 bg-red-50 break-all",children:JSON.stringify(a[r])||"-"}),e.jsx("td",{className:"px-4 py-2 text-green-600 bg-green-50 break-all",children:JSON.stringify(h[r])||"-"})]},r))})]})})}const p=Object.keys(t).filter(a=>a!=="ip"&&a!=="user_agent");return p.length===0?e.jsx("p",{className:"text-gray-500",children:"Tidak ada detail tambahan."}):e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Info Tambahan"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Nilai"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 text-sm",children:p.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 font-medium text-gray-700 capitalize",children:a.replace(/_/g," ")}),e.jsx("td",{className:"px-4 py-2 text-gray-600 break-all",children:typeof t[a]=="object"?JSON.stringify(t[a]):String(t[a])})]},a))})]})})};return e.jsxs(w,{header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Log Aktivitas Sistem"}),children:[e.jsx(v,{title:"Log Aktivitas"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-6",children:[e.jsx("div",{className:"mb-6 w-full sm:w-1/3",children:e.jsx(k,{type:"text",placeholder:"Cari user atau deskripsi...",className:"w-full",value:l,onChange:t=>j(t.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Waktu"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User (Pelaku)"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"IP Address"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Modul"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Aksi"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Akses"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.data.length>0?d.data.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.created_at}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.causer}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-mono",children:t.ip_address}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:t.subject_type})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`font-bold uppercase text-xs mb-1 
                                                            ${t.event==="created"?"text-green-600":t.event==="deleted"?"text-red-600":"text-yellow-600"}`,children:t.event}),e.jsx("button",{onClick:()=>f(t),className:"text-indigo-600 hover:text-indigo-900 text-xs underline text-left",children:"Lihat Detail Perubahan"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t.target_url?e.jsxs(g,{href:t.target_url,className:"text-gray-600 hover:text-gray-900 hover:underline flex items-center gap-1",children:[e.jsx("span",{children:"Buka"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"})})]}):e.jsx("span",{className:"text-gray-400 cursor-not-allowed",children:"link N/A"})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center text-gray-500",children:"Belum ada aktivitas terekam."})})})]})}),e.jsx("div",{className:"mt-4 flex justify-end gap-2",children:d.links.map((t,o)=>e.jsx(g,{href:t.url||"#",className:`px-3 py-1 border rounded text-sm ${t.active?"bg-indigo-500 text-white":"bg-white text-gray-700"} ${!t.url&&"opacity-50 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:t.label}},o))})]})})}),e.jsx(S,{show:y,onClose:m,children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Detail Aktivitas"}),s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block",children:"Waktu:"}),e.jsx("span",{className:"font-semibold",children:s.created_at})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block",children:"IP Address:"}),e.jsx("span",{className:"font-mono bg-gray-100 px-2 py-0.5 rounded",children:s.ip_address})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block",children:"User-Agent:"}),e.jsx("span",{className:"text-xs text-gray-600 break-all",children:s.properties?.user_agent||"-"})]})]}),e.jsxs("div",{className:"mt-4",children:[s.properties?.context&&e.jsxs("div",{className:"mb-6 bg-blue-50 border border-blue-100 rounded-lg p-3",children:[e.jsx("h3",{className:"font-bold text-blue-900 text-xs uppercase tracking-wider mb-2",children:"Informasi Transaksi"}),e.jsxs("div",{className:"grid grid-cols-2 gap-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Judul Transaksi"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.properties.context.title})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Nominal"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.properties.context.amount})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Tanggal Transaksi"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.properties.context.transacted_at})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Tipe Biaya"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.properties.context.expense_type})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Proyek"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.properties.context.project})]})]})]}),e.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"Perubahan Data:"}),N(s.properties)]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(_,{onClick:m,children:"Tutup"})})]})})]})}export{P as default};
