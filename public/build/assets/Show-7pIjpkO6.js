import{r as h,u as q,j as e,H as G,c as N}from"./app-iadIdocp.js";import{B as X,S as H}from"./BendaharaLayout-DkJHnOIo.js";import{P as Z}from"./PageHeader-D3UT0ols.js";import{D as k,a as ee}from"./Dropdown-i7i80dcK.js";import{M as D,S as T}from"./SecondaryButton-CPx7YyNf.js";import{I as n}from"./InputLabel-DgqoCkEg.js";import{T as x}from"./TextInput-CXo6vupj.js";import{P as z}from"./PrimaryButton-CeFZw7mH.js";import{I as u}from"./InputError-BEzrBLSy.js";/* empty css            */import"./ApplicationLogo-6QNFfugt.js";import"./transition-BJ0O2Yr_.js";import"./with-selector-CN4KNt0j.js";const g=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t),ae=({project:t,expenseTypes:C})=>{const{setOpen:j}=h.useContext(ee),[c,_]=h.useState(""),m=()=>{window.open(route("bendahara.projects.export",{project:t.slug||t.id}),"_blank"),j(!1)},B=()=>{if(!c){alert("Pilih tipe biaya terlebih dahulu");return}window.open(route("bendahara.projects.export",{project:t.slug||t.id,expense_type_id:c}),"_blank"),j(!1)};return e.jsxs(k.Content,{closeOnClick:!1,width:"64",children:[e.jsx("div",{className:"block px-4 py-2 text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Export Laporan"}),e.jsx(k.Link,{as:"button",onClick:m,className:"w-full text-left",children:"PDF (Semua Kategori)"}),e.jsx("div",{className:"border-t border-gray-100 my-1"}),e.jsxs("div",{className:"px-4 py-3 space-y-3",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Export Per Tipe Biaya"}),e.jsxs("select",{value:c,onChange:o=>_(o.target.value),className:"block w-full rounded-lg border-gray-200 py-1.5 text-sm focus:border-indigo-500 focus:ring-indigo-500 shadow-sm",children:[e.jsx("option",{value:"",children:"Pilih Tipe"}),C.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]}),e.jsxs("button",{onClick:B,className:"w-full inline-flex justify-center items-center rounded-lg bg-indigo-600 px-3 py-2 text-xs font-bold text-white shadow-sm hover:bg-indigo-500 transition-colors",children:[e.jsx("svg",{className:"w-3 h-3 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export Tipe Biaya"]})]})]})};function ge({project:t,mandors:C,benderas:j,expenseTypes:c}){const[_,m]=h.useState(!1),[B,o]=h.useState(!1),[S,v]=h.useState(null),[p,E]=h.useState("transacted_at"),b=t.status==="completed",F=t.expenses.reduce((a,s)=>a+parseFloat(s.amount),0),{data:l,setData:d,post:R,processing:W,errors:w,reset:M}=q({project_id:t.id,expense_type_id:"",title:"",transacted_at:new Date().toISOString().split("T")[0],description:"",receipt_image:null,items:[{name:"",quantity:1,price:0}]}),$=l.items.reduce((a,s)=>a+s.quantity*s.price,0),r=q({name:t.name,description:t.description||"",status:t.status,coordinates:t.coordinates||"",mandor_id:t.mandor_id||"",mandor_ids:t.mandors?t.mandors.map(a=>a.id):t.mandor_id?[t.mandor_id]:[],bendera_id:t.bendera_id||"",location:t.location||""}),I=[...t.expenses].sort((a,s)=>{const i=new Date(a[p]);return new Date(s[p])-i}),[f,L]=h.useState(null),A=()=>{d("items",[...l.items,{name:"",quantity:1,price:0}])},V=a=>{const s=l.items.filter((i,y)=>y!==a);d("items",s)},P=(a,s,i)=>{const y=[...l.items];y[a][s]=i,d("items",y)},O=()=>{L(null),d({project_id:t.id,expense_type_id:"",title:"",transacted_at:new Date().toISOString().split("T")[0],description:"",receipt_image:null,items:[{name:"",quantity:1,price:0}]}),m(!0)},J=a=>{L(a.id),d({project_id:t.id,expense_type_id:a.expense_type_id||"",title:a.title,transacted_at:a.transacted_at,description:a.description||"",receipt_image:null,items:a.items.map(s=>({name:s.name,quantity:s.quantity,price:s.price}))}),m(!0)},U=a=>{a.preventDefault(),f?N.post(route("bendahara.expenses.update",f),{_method:"put",...l},{onSuccess:()=>{m(!1),M(),L(null)},preserveScroll:!0,forceFormData:!0}):R(route("bendahara.expenses.store"),{onSuccess:()=>{m(!1),M()},forceFormData:!0})},K=a=>{a.preventDefault(),r.put(route("bendahara.projects.update",t.slug||t.id),{onSuccess:()=>o(!1)})},Y=a=>{H.fire({title:"Hapus Pengeluaran?",text:"Data pengeluaran ini akan dihapus permanen.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",cancelButtonColor:"#6b7280",confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal"}).then(s=>{s.isConfirmed&&N.delete(route("bendahara.expenses.destroy",a))})},Q=()=>{H.fire({title:"Hapus Proyek?",html:`<p class="text-gray-600">Proyek <strong>${t.name}</strong> beserta seluruh data pengeluaran akan dihapus permanen.</p>`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",cancelButtonColor:"#6b7280",confirmButtonText:"Ya, Hapus Proyek",cancelButtonText:"Batal",customClass:{popup:"rounded-xl",confirmButton:"rounded-lg",cancelButton:"rounded-lg"}}).then(a=>{a.isConfirmed&&N.delete(route("bendahara.projects.destroy",t.slug||t.id))})};return e.jsxs(X,{children:[e.jsx(G,{title:`Proyek: ${t.name}`}),e.jsx(Z,{title:t.name,backLink:route("bendahara.projects.index"),backLabel:"Daftar Proyek",badge:{text:b?"Selesai":"Berjalan",variant:b?"green":"blue"},meta:e.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[t.bendera&&e.jsxs("div",{className:"inline-block px-2 py-0.5 rounded text-[10px] font-bold tracking-wide uppercase bg-purple-100 text-purple-700 w-fit",children:["ðŸ¢ ",t.bendera.name]}),t.mandors&&t.mandors.length>0?e.jsx("div",{className:"space-y-1",children:t.mandors.map((a,s)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Pelaksana ",s+1,": ",e.jsx("span",{className:"font-medium text-gray-900",children:a.name})]},a.id))}):t.mandor&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Pelaksana: ",e.jsx("span",{className:"font-medium text-gray-900",children:t.mandor.name})]}),t.location&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsxs("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),t.location]})]}),actions:e.jsxs("div",{className:"flex items-center gap-2",children:[!b&&e.jsx("button",{onClick:()=>o(!0),className:"p-2 text-gray-500 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition",title:"Edit Proyek",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:Q,className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition",title:"Hapus Proyek",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("div",{className:"w-px h-6 bg-gray-200 mx-1"}),e.jsxs(k,{children:[e.jsx(k.Trigger,{children:e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 text-gray-700 font-medium rounded-lg hover:bg-gray-50 shadow-sm text-sm",children:[e.jsx("svg",{className:"w-4 h-4 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export",e.jsx("svg",{className:"ml-1 h-4 w-4 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})}),e.jsx(ae,{project:t,expenseTypes:c})]}),b?e.jsx("div",{className:"px-3 py-2 bg-gray-100 text-gray-500 font-medium rounded-lg border border-gray-200 cursor-not-allowed text-sm",children:"Terkunci"}):e.jsxs("button",{onClick:O,className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 shadow-sm text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Catat Pengeluaran"]})]})}),(t.description||t.coordinates)&&e.jsxs("div",{className:"mb-6 bg-white rounded-xl border border-gray-200 p-5 shadow-sm",children:[t.description&&e.jsx("p",{className:"text-gray-600 mb-4",children:t.description}),t.coordinates&&e.jsxs("div",{className:"rounded-lg overflow-hidden border border-gray-200 shadow-sm bg-gray-100",children:[e.jsx("iframe",{width:"100%",height:"200",frameBorder:"0",scrolling:"no",marginHeight:"0",marginWidth:"0",src:`https://maps.google.com/maps?q=${encodeURIComponent(t.coordinates)}&hl=id&z=14&output=embed`}),e.jsxs("div",{className:"p-2 bg-white flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500 truncate max-w-[200px]",children:t.coordinates}),e.jsx("a",{href:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(t.coordinates)}`,target:"_blank",rel:"noreferrer",className:"text-indigo-600 font-medium hover:underline",children:"Buka di Maps â†’"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"text-gray-500 text-sm font-medium",children:"Total Pengeluaran"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:g(F)})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"text-gray-500 text-sm font-medium",children:"Jumlah Transaksi"}),e.jsxs("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:[t.expenses.length," Nota"]})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"text-gray-500 text-sm font-medium",children:"Terakhir Update"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:t.expenses.length>0?new Date(t.expenses[0].transacted_at).toLocaleDateString("id-ID",{day:"numeric",month:"short"}):"-"})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50 flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Riwayat Pengeluaran"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("select",{value:new URLSearchParams(window.location.search).get("expense_type_id")||"",onChange:a=>{const s=new URLSearchParams(window.location.search);a.target.value?s.set("expense_type_id",a.target.value):s.delete("expense_type_id"),N.get(`${window.location.pathname}?${s.toString()}`,{},{preserveState:!0,preserveScroll:!0})},className:"text-xs border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",children:[e.jsx("option",{value:"",children:"Semua Tipe Biaya"}),c&&c.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1 hidden sm:block"}),e.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>E("transacted_at"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition ${p==="transacted_at"?"bg-white text-indigo-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Tanggal Nota"}),e.jsx("button",{onClick:()=>E("created_at"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition ${p==="created_at"?"bg-white text-indigo-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Tanggal Input"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Detail"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bukti"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[I.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 align-top",children:e.jsx("div",{className:"font-semibold text-gray-900",children:new Date(a[p]).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})})}),e.jsxs("td",{className:"px-6 py-4 align-top",children:[e.jsx("div",{className:"font-bold text-indigo-700 mb-1",children:a.title}),a.items&&a.items.length>0?e.jsx("ul",{className:"text-sm text-gray-700 bg-gray-50 rounded-md p-2 space-y-1 border border-gray-100",children:a.items.map((s,i)=>e.jsxs("li",{className:"flex justify-between items-center border-b border-gray-100 last:border-0 pb-1 last:pb-0",children:[e.jsxs("span",{className:"flex-1",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",s.quantity," x ",g(s.price),")"]})]}),e.jsx("span",{className:"font-medium text-gray-900 ml-4",children:g(s.total_price)})]},s.id||i))}):e.jsx("div",{className:"text-sm text-gray-500 italic",children:"Tidak ada detail item."}),a.description&&e.jsxs("div",{className:"text-xs text-gray-500 mt-2 italic",children:['"',a.description,'"']})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center align-top",children:a.receipt_image?e.jsx("button",{onClick:()=>v(`/storage/${a.receipt_image}`),className:"text-indigo-600 hover:text-indigo-900 text-xs font-medium underline border border-indigo-200 rounded px-2 py-1 bg-indigo-50",children:"Lihat Foto"}):e.jsx("span",{className:"text-gray-400 text-xs italic",children:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-bold text-gray-900 align-top",children:g(a.amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium align-top",children:!b&&e.jsxs("div",{className:"flex flex-col gap-2 align-end",children:[e.jsx("button",{onClick:()=>J(a),className:"text-indigo-600 hover:text-indigo-900 bg-indigo-50 px-2 py-1 rounded hover:bg-indigo-100 text-xs text-center",children:"Edit"}),e.jsx("button",{onClick:()=>Y(a.id),className:"text-red-600 hover:text-red-900 bg-red-50 px-2 py-1 rounded hover:bg-red-100 text-xs text-center",children:"Hapus"})]})})]},a.id)),I.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-12 text-center text-gray-500",children:"Belum ada pengeluaran tercatat."})})]})]})})]}),e.jsx(D,{show:B,onClose:()=>o(!1),children:e.jsxs("form",{onSubmit:K,className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Edit Data Proyek"}),e.jsxs("div",{className:"mb-4",children:[e.jsx(n,{value:"Nama Proyek"}),e.jsx(x,{value:r.data.name,onChange:a=>r.setData("name",a.target.value),className:"mt-1 block w-full",required:!0}),e.jsx(u,{message:r.errors.name,className:"mt-2"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:e.jsxs("div",{children:[e.jsx(n,{value:"Bendera (PT/CV)"}),e.jsxs("select",{value:r.data.bendera_id,onChange:a=>r.setData("bendera_id",a.target.value),className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",children:[e.jsx("option",{value:"",children:"-- Pilih Bendera --"}),j.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsx(u,{message:r.errors.bendera_id,className:"mt-2"})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx(n,{value:"Pelaksana (Bisa Pilih Lebih dari 1)"}),e.jsx("div",{className:"mt-1 border border-gray-300 rounded-md p-2 max-h-32 overflow-y-auto bg-gray-50",children:C.map(a=>e.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-100 rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.data.mandor_ids.includes(a.id),onChange:s=>{s.target.checked?r.setData("mandor_ids",[...r.data.mandor_ids,a.id]):r.setData("mandor_ids",r.data.mandor_ids.filter(i=>i!==a.id))},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsxs("span",{className:"text-sm text-gray-700",children:[a.name," (",a.whatsapp_number,")"]})]},a.id))}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Pilih satu atau lebih pelaksana untuk proyek ini"}),e.jsx(u,{message:r.errors.mandor_ids,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(n,{value:"Lokasi Proyek (Teks)"}),e.jsx(x,{value:r.data.location,onChange:a=>r.setData("location",a.target.value),className:"mt-1 block w-full",placeholder:"Contoh: Jl. Sudirman No. 45, Jakarta"}),e.jsx(u,{message:r.errors.location,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(n,{value:"Deskripsi"}),e.jsx("textarea",{value:r.data.description,onChange:a=>r.setData("description",a.target.value),className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",rows:"3"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(n,{value:"Koordinat Lokasi (Maps)"}),e.jsx(x,{value:r.data.coordinates,onChange:a=>r.setData("coordinates",a.target.value),className:"mt-1 block w-full",placeholder:`6Â°52'09.6"S 109Â°02'34.5"E`}),e.jsx(u,{message:r.errors.coordinates,className:"mt-2"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(n,{value:"Status"}),e.jsxs("select",{value:r.data.status,onChange:a=>r.setData("status",a.target.value),className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",children:[e.jsx("option",{value:"ongoing",children:"Sedang Berjalan"}),e.jsx("option",{value:"completed",children:"Selesai"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(T,{onClick:()=>o(!1),children:"Batal"}),e.jsx(z,{disabled:r.processing,children:"Simpan Perubahan"})]})]})}),e.jsx(D,{show:_,onClose:()=>m(!1),children:e.jsxs("form",{onSubmit:U,className:"p-6 max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:f?"Edit Pengeluaran":"Catat Pengeluaran Baru"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx(n,{value:"Judul Nota / Toko"}),e.jsx(x,{value:l.title,onChange:a=>d("title",a.target.value),className:"mt-1 block w-full",placeholder:"Cth: TB. Sinar Jaya",required:!0}),e.jsx(u,{message:w.title,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{value:"Tipe Biaya"}),e.jsxs("select",{value:l.expense_type_id,onChange:a=>d("expense_type_id",a.target.value),className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",required:!0,children:[e.jsx("option",{value:"",children:"-- Pilih Tipe Biaya --"}),c&&c.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsx(u,{message:w.expense_type_id,className:"mt-2"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(n,{value:"Tanggal Transaksi"}),e.jsx(x,{type:"date",value:l.transacted_at,onChange:a=>d("transacted_at",a.target.value),className:"mt-1 block w-full",required:!0})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx(n,{value:"Daftar Barang"}),e.jsx("button",{type:"button",onClick:A,className:"text-xs bg-indigo-50 text-indigo-700 px-2 py-1 rounded hover:bg-indigo-100 font-medium border border-indigo-200",children:"+ Tambah Item"})]}),e.jsx("div",{className:"space-y-3 bg-gray-50 p-3 rounded-lg border border-gray-200",children:l.items.map((a,s)=>e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-start sm:items-center bg-white p-2 rounded shadow-sm",children:[e.jsx("div",{className:"flex-1 w-full",children:e.jsx(x,{placeholder:"Nama Barang",value:a.name,onChange:i=>P(s,"name",i.target.value),className:"w-full text-sm",required:!0})}),e.jsx("div",{className:"w-20",children:e.jsx(x,{type:"number",placeholder:"Qty",value:a.quantity,onChange:i=>P(s,"quantity",parseInt(i.target.value)||0),className:"w-full text-sm text-center",min:"1",required:!0})}),e.jsx("div",{className:"w-32",children:e.jsx(x,{type:"number",placeholder:"Harga @",value:a.price,onChange:i=>P(s,"price",parseFloat(i.target.value)||0),className:"w-full text-sm text-right",min:"0",required:!0})}),e.jsx("div",{className:"w-32 text-right text-sm font-semibold text-gray-700 px-2",children:g(a.quantity*a.price)}),l.items.length>1&&e.jsx("button",{type:"button",onClick:()=>V(s),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},s))}),w.items&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:w.items})]}),e.jsxs("div",{className:"flex justify-between items-center bg-indigo-50 p-3 rounded-lg border border-indigo-100 mb-4",children:[e.jsx("span",{className:"font-semibold text-indigo-900",children:"Total Nota"}),e.jsx("span",{className:"text-xl font-bold text-indigo-700",children:g($)})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(n,{value:"Foto Struk (Opsional)"}),f&&!l.receipt_image&&e.jsx("p",{className:"text-xs text-gray-500 mb-1 italic",children:"*Biarkan kosong jika tidak ingin mengubah foto"}),e.jsx("input",{type:"file",onChange:a=>d("receipt_image",a.target.files[0]),className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",accept:"image/*"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(n,{value:"Catatan Tambahan (Opsional)"}),e.jsx("textarea",{value:l.description,onChange:a=>d("description",a.target.value),className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm text-sm",rows:"2",placeholder:"Keterangan lain jika diperlukan..."})]}),e.jsxs("div",{className:"flex justify-end gap-3 sticky bottom-0 bg-white pt-4 border-t border-gray-100",children:[e.jsx(T,{onClick:()=>m(!1),children:"Batal"}),e.jsx(z,{disabled:W,children:f?"Simpan Perubahan":"Simpan Pengeluaran"})]})]})}),e.jsx(D,{show:!!S,onClose:()=>v(null),children:e.jsxs("div",{className:"p-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 sticky top-0 bg-white z-10 pb-2",children:[e.jsx("h3",{className:"font-medium",children:"Bukti Transaksi"}),e.jsx("button",{type:"button",onClick:()=>v(null),className:"text-gray-400 hover:text-gray-600 text-2xl leading-none",children:"Ã—"})]}),S&&e.jsx("img",{src:S,alt:"Struk",className:"w-full h-auto max-h-[75vh] object-contain rounded-lg border border-gray-200"}),e.jsx("div",{className:"mt-4 text-right",children:e.jsx(T,{onClick:()=>v(null),children:"Tutup"})})]})})]})}export{ge as default};
