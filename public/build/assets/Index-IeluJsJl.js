import{r as i,a as v,j as e,H as k,L as _}from"./app-1GuRuwXM.js";import{B as S}from"./BendaharaLayout-azH27Bhb.js";import{M as L}from"./Modal-BxR1ZytI.js";import{S as w}from"./SecondaryButton-DfEV9W92.js";import{P as T,B as u}from"./PageHeader-Lgi7j_5r.js";import{S as A}from"./SearchInput-VdKusAVh.js";import{D as B}from"./DataTable-C9-oGE8D.js";/* empty css            */import"./ApplicationLogo-ji5Nsjxc.js";import"./transition-CrexFo9_.js";import"./use-sync-refs-j05iY-EP.js";import"./open-closed-JmYsaq0p.js";import"./keyboard-7ucfL_9T.js";import"./with-selector-DWV7iKPJ.js";import"./description-C1II6esh.js";import"./close-provider-DUthU0z7.js";function K({logs:n,filters:d}){const[l,g]=i.useState(d.search||""),[t,c]=i.useState(null),[j,x]=i.useState(!1);i.useEffect(()=>{const s=setTimeout(()=>{l!==(d.search||"")&&v.get(route("superadmin.activity_logs.index"),{search:l},{preserveState:!0,replace:!0})},500);return()=>clearTimeout(s)},[l]);const y=s=>{c(s),x(!0)},o=()=>{x(!1),c(null)},b=s=>{if(!s)return e.jsx("p",{className:"text-gray-500",children:"Tidak ada detail perubahan."});if(s.old||s.attributes){const a=s.old||{},p=s.attributes||{},h=[...new Set([...Object.keys(a),...Object.keys(p)])].filter(r=>r!=="ip"&&r!=="user_agent");return h.length===0?e.jsx("p",{className:"text-gray-500",children:"Tidak ada atribut yang berubah."}):e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase",children:"Field"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase",children:"Lama"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase",children:"Baru"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 text-sm",children:h.map(r=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 font-medium text-gray-700",children:r}),e.jsx("td",{className:"px-4 py-2 text-red-600 bg-red-50 break-all",children:JSON.stringify(a[r])||"-"}),e.jsx("td",{className:"px-4 py-2 text-green-600 bg-green-50 break-all",children:JSON.stringify(p[r])||"-"})]},r))})]})})}const m=Object.keys(s).filter(a=>a!=="ip"&&a!=="user_agent");return m.length===0?e.jsx("p",{className:"text-gray-500",children:"Tidak ada detail tambahan."}):e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase",children:"Info Tambahan"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase",children:"Nilai"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 text-sm",children:m.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 font-medium text-gray-700 capitalize",children:a.replace(/_/g," ")}),e.jsx("td",{className:"px-4 py-2 text-gray-600 break-all",children:typeof s[a]=="object"?JSON.stringify(s[a]):String(s[a])})]},a))})]})})},f=s=>s==="created"?"green":s==="deleted"?"red":"yellow",N=[{key:"created_at",label:"Waktu",render:s=>e.jsx("span",{className:"text-gray-500 whitespace-nowrap",children:s.created_at})},{key:"causer",label:"User (Pelaku)",render:s=>e.jsx("span",{className:"font-medium text-gray-900",children:s.causer})},{key:"ip_address",label:"IP Address",render:s=>e.jsx("span",{className:"text-gray-500 font-mono text-xs",children:s.ip_address})},{key:"subject_type",label:"Modul",render:s=>e.jsx(u,{variant:"blue",size:"md",children:s.subject_type})},{key:"event",label:"Aksi",render:s=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(u,{variant:f(s.event),size:"sm",children:s.event}),e.jsx("button",{onClick:()=>y(s),className:"text-indigo-600 hover:text-indigo-800 text-xs font-medium text-left transition-colors",children:"Lihat Detail"})]})},{key:"target_url",label:"Akses",render:s=>s.target_url?e.jsxs(_,{href:s.target_url,className:"text-gray-600 hover:text-indigo-600 flex items-center gap-1 text-sm font-medium transition-colors",children:[e.jsx("span",{children:"Buka"}),e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"})})]}):e.jsx("span",{className:"text-gray-300 text-sm",children:"N/A"})}];return e.jsxs(S,{children:[e.jsx(k,{title:"Log Aktivitas"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(T,{title:"Log Aktivitas Sistem"}),e.jsx(A,{value:l,onChange:g,placeholder:"Cari user atau deskripsi...",maxWidth:"max-w-sm"}),e.jsx(B,{columns:N,data:n.data,emptyMessage:"Belum ada aktivitas terekam.",pagination:n.links,compact:!0})]}),e.jsx(L,{show:j,onClose:o,children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Detail Aktivitas"}),t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block text-xs mb-0.5",children:"Waktu"}),e.jsx("span",{className:"font-semibold",children:t.created_at})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block text-xs mb-0.5",children:"IP Address"}),e.jsx("span",{className:"font-mono bg-gray-100 px-2 py-0.5 rounded text-sm",children:t.ip_address})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500 block text-xs mb-0.5",children:"User-Agent"}),e.jsx("span",{className:"text-xs text-gray-600 break-all",children:t.properties?.user_agent||"-"})]})]}),t.properties?.context&&e.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-4",children:[e.jsx("h3",{className:"font-bold text-blue-900 text-xs uppercase tracking-wider mb-3",children:"Informasi Transaksi"}),e.jsxs("div",{className:"grid grid-cols-2 gap-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Judul"}),e.jsx("span",{className:"font-medium text-gray-900",children:t.properties.context.title})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Nominal"}),e.jsx("span",{className:"font-medium text-gray-900",children:t.properties.context.amount})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Tanggal"}),e.jsx("span",{className:"font-medium text-gray-900",children:t.properties.context.transacted_at})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Tipe Biaya"}),e.jsx("span",{className:"font-medium text-gray-900",children:t.properties.context.expense_type})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Proyek"}),e.jsx("span",{className:"font-medium text-gray-900",children:t.properties.context.project})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"Perubahan Data:"}),b(t.properties)]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(w,{onClick:o,children:"Tutup"})})]})})]})}export{K as default};
