import{r as x,u as g,j as e,H as M,L as C}from"./app-DKzJqvPg.js";import{B as I}from"./BendaharaLayout-DE1Qpor3.js";import{P}from"./PageHeader-DIJlI78N.js";import{M as j}from"./Modal-BjWi9IeX.js";import{T as r}from"./TextInput-DssbnquE.js";import{I as n}from"./InputLabel-B7YG9MXE.js";import{P as y}from"./PrimaryButton-1n-OJa10.js";import{S as N}from"./SecondaryButton-CUup-Gjt.js";import{A as T}from"./arrow-left-D3CGrckR.js";import{c as i}from"./createLucideIcon-CQ7JtDoJ.js";import{H as F}from"./history-B6uaWxfb.js";/* empty css            */import"./ApplicationLogo-DAbpYrt-.js";import"./transition-B3VjuBuZ.js";import"./with-selector-mLoZtnvf.js";const B=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],L=i("circle-check",B);const $=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],z=i("clock",$);const O=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],b=i("credit-card",O);const H=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],q=i("file-down",H);const A=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],R=i("file-spreadsheet",A);const V=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],E=i("plus",V);const K=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],J=i("receipt",K);function de({project:l,unbilled_shipments:h,billed_shipments:p,payments:u}){const[d,f]=x.useState("unbilled"),[v,c]=x.useState(!1),[k,o]=x.useState(!1),t=g({amount:"",date:new Date().toISOString().split("T")[0],description:"Pembayaran Piutang",notes:""}),s=g({start_date:"",end_date:new Date().toISOString().split("T")[0],invoice_date:new Date().toISOString().split("T")[0],mark_as_billed:!0}),m=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(a),w=a=>{a.preventDefault(),t.post(route("receivable.project.payment.store",l.id),{onSuccess:()=>{c(!1),t.reset()}})},_=a=>{a.preventDefault();const S=route("receivable.project.export-invoice",{project:l.id,...s.data});window.open(S,"_blank"),o(!1)},D=[{id:"unbilled",label:"Belum Ditagih",icon:z},{id:"history",label:"Riwayat Tagihan",icon:F},{id:"payments",label:"Pembayaran",icon:b}];return e.jsxs(I,{children:[e.jsx(M,{title:`Transaksi ${l.name}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(C,{href:route("receivable.customer.show",l.customer_id),className:"inline-flex items-center text-sm font-medium text-slate-500 hover:text-slate-900 transition-colors",children:[e.jsx(T,{className:"mr-1 w-4 h-4"}),"Kembali ke Daftar Proyek"]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4",children:[e.jsx(P,{title:l.name,subtitle:`${l.customer.name} - ${l.location||"No Location"}`,icon:R}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>c(!0),className:"bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2.5 rounded-xl text-sm font-bold flex items-center transition-all shadow-sm",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Input Pembayaran"]}),e.jsxs("button",{onClick:()=>o(!0),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2.5 rounded-xl text-sm font-bold flex items-center transition-all shadow-sm",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Buat Invoice"]})]})]}),e.jsx("div",{className:"flex border-b border-slate-200 gap-8",children:D.map(a=>e.jsxs("button",{onClick:()=>f(a.id),className:`pb-4 text-sm font-bold flex items-center gap-2 transition-all relative ${d===a.id?"text-indigo-600":"text-slate-500 hover:text-slate-700"}`,children:[e.jsx(a.icon,{className:"w-4 h-4"}),a.label,d===a.id&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-600 rounded-full"})]},a.id))}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden",children:[d==="unbilled"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50/50 text-slate-500 text-xs font-bold uppercase tracking-wider",children:[e.jsx("th",{className:"px-6 py-4",children:"Tanggal"}),e.jsx("th",{className:"px-6 py-4",children:"No. Docket (DN)"}),e.jsx("th",{className:"px-6 py-4",children:"Mutu"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Volume"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Harga Satuan"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Total"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:h.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-slate-500 italic",children:"Semua pengiriman sudah ditagih."})}):h.map(a=>e.jsxs("tr",{className:"text-sm",children:[e.jsx("td",{className:"px-6 py-4",children:new Date(a.date).toLocaleDateString("id-ID")}),e.jsx("td",{className:"px-6 py-4 font-mono font-bold text-indigo-600",children:a.docket_number}),e.jsx("td",{className:"px-6 py-4",children:a.concrete_grade?.code||"-"}),e.jsxs("td",{className:"px-6 py-4 text-center",children:[a.volume," M3"]}),e.jsx("td",{className:"px-6 py-4 text-right",children:m(a.price_per_m3)}),e.jsx("td",{className:"px-6 py-4 text-right font-bold",children:m(a.total_price)})]},a.id))})]})}),d==="history"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50/50 text-slate-500 text-xs font-bold uppercase tracking-wider",children:[e.jsx("th",{className:"px-6 py-4",children:"Tanggal"}),e.jsx("th",{className:"px-6 py-4",children:"No. Docket (DN)"}),e.jsx("th",{className:"px-6 py-4",children:"Mutu"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Volume"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Total"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:p.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-slate-500 italic",children:"Belum ada riwayat tagihan."})}):p.map(a=>e.jsxs("tr",{className:"text-sm",children:[e.jsx("td",{className:"px-6 py-4",children:new Date(a.date).toLocaleDateString("id-ID")}),e.jsx("td",{className:"px-6 py-4 font-mono font-bold text-slate-600",children:a.docket_number}),e.jsx("td",{className:"px-6 py-4",children:a.concrete_grade?.code||"-"}),e.jsxs("td",{className:"px-6 py-4 text-center",children:[a.volume," M3"]}),e.jsx("td",{className:"px-6 py-4 text-right",children:m(a.total_price)}),e.jsx("td",{className:"px-6 py-4 text-center text-emerald-600 font-bold",children:e.jsxs("span",{className:"inline-flex items-center",children:[e.jsx(L,{className:"w-4 h-4 mr-1"})," Billed"]})})]},a.id))})]})}),d==="payments"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50/50 text-slate-500 text-xs font-bold uppercase tracking-wider",children:[e.jsx("th",{className:"px-6 py-4",children:"Tanggal"}),e.jsx("th",{className:"px-6 py-4",children:"Keterangan"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Jumlah Pembayaran"}),e.jsx("th",{className:"px-6 py-4",children:"Catatan"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:u.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-6 py-12 text-center text-slate-500 italic",children:"Belum ada transaksi pembayaran."})}):u.map(a=>e.jsxs("tr",{className:"text-sm",children:[e.jsx("td",{className:"px-6 py-4",children:new Date(a.date).toLocaleDateString("id-ID")}),e.jsx("td",{className:"px-6 py-4 font-bold",children:a.description}),e.jsx("td",{className:"px-6 py-4 text-right text-emerald-600 font-bold",children:m(a.amount)}),e.jsx("td",{className:"px-6 py-4 text-slate-500",children:a.notes||"-"})]},a.id))})]})})]})]}),e.jsx(j,{show:v,onClose:()=>c(!1),maxWidth:"md",children:e.jsxs("form",{onSubmit:w,className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-900 mb-6 flex items-center",children:[e.jsx(b,{className:"w-6 h-6 mr-2 text-emerald-600"}),"Input Pembayaran Baru"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"amount",value:"Jumlah Pembayaran (Rp)"}),e.jsx(r,{id:"amount",type:"number",className:"mt-1 block w-full",value:t.data.amount,onChange:a=>t.setData("amount",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"date",value:"Tanggal Transaksi"}),e.jsx(r,{id:"date",type:"date",className:"mt-1 block w-full",value:t.data.date,onChange:a=>t.setData("date",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"description",value:"Keterangan"}),e.jsx(r,{id:"description",className:"mt-1 block w-full",value:t.data.description,onChange:a=>t.setData("description",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"notes",value:"Catatan Tambahan (Opsional)"}),e.jsx("textarea",{id:"notes",className:"mt-1 block w-full border-slate-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",rows:"3",value:t.data.notes,onChange:a=>t.setData("notes",a.target.value)})]})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-3",children:[e.jsx(N,{onClick:()=>c(!1),children:"Batal"}),e.jsx(y,{disabled:t.processing,className:"bg-emerald-600 hover:bg-emerald-700",children:"Simpan Pembayaran"})]})]})}),e.jsx(j,{show:k,onClose:()=>o(!1),maxWidth:"md",children:e.jsxs("form",{onSubmit:_,className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-900 mb-6 flex items-center",children:[e.jsx(q,{className:"w-6 h-6 mr-2 text-indigo-600"}),"Generate Invoice PDF"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"start_date",value:"Dari Tanggal (DN)"}),e.jsx(r,{id:"start_date",type:"date",className:"mt-1 block w-full",value:s.data.start_date,onChange:a=>s.setData("start_date",a.target.value)}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-1",children:"* Kosongkan untuk semua"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"end_date",value:"Sampai Tanggal (DN)"}),e.jsx(r,{id:"end_date",type:"date",className:"mt-1 block w-full",value:s.data.end_date,onChange:a=>s.setData("end_date",a.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"invoice_date",value:"Tanggal Invoice (Di Cetakan)"}),e.jsx(r,{id:"invoice_date",type:"date",className:"mt-1 block w-full",value:s.data.invoice_date,onChange:a=>s.setData("invoice_date",a.target.value),required:!0})]}),e.jsxs("div",{className:"flex items-center mt-4",children:[e.jsx("input",{type:"checkbox",id:"mark_as_billed",className:"rounded border-slate-300 text-indigo-600 shadow-sm focus:ring-indigo-500",checked:s.data.mark_as_billed,onChange:a=>s.setData("mark_as_billed",a.target.checked)}),e.jsx("label",{htmlFor:"mark_as_billed",className:"ml-2 text-sm text-slate-700 font-medium",children:'Tandai pengiriman sebagai "Sudah Ditagih"'})]})]}),e.jsx("p",{className:"mt-6 text-xs text-slate-500 bg-slate-50 p-3 rounded-lg border border-slate-100",children:"* Export ini akan mencakup pengiriman dalam periode yang dipilih dan otomatis menghitung total DP/pembayaran yang telah masuk hingga tanggal invoice."}),e.jsxs("div",{className:"mt-8 flex justify-end gap-3",children:[e.jsx(N,{onClick:()=>o(!1),children:"Batal"}),e.jsx(y,{className:"bg-indigo-600 hover:bg-indigo-700",children:"Unduh PDF Invoice"})]})]})})]})}export{de as default};
