import{r as c,u as z,e as y,j as e,H as F,L as $}from"./app-DDkThiwp.js";import{B as W,S as p}from"./BendaharaLayout-DkT6SKYz.js";import{P as w}from"./PrimaryButton-zZtWvJJz.js";import{S as K}from"./SecondaryButton-OFDyRyhG.js";import{M as O}from"./Modal-cheLN1Sv.js";import{I as n}from"./InputLabel-BYYSUQrg.js";import{T as g}from"./TextInput-cppD8dzz.js";import{I as l}from"./InputError-DtOQ83N4.js";import{C as R}from"./Checkbox-BUyWJ6W9.js";import{P as V,B as C}from"./PageHeader-C2PkCXBo.js";import{S as q}from"./SearchInput-BTeeFBvO.js";import{D as Y}from"./DataTable-g21gu-uf.js";/* empty css            */import"./ApplicationLogo-0iz7Fc7z.js";import"./transition-BAZ8-2fJ.js";import"./with-selector-DBl-jayN.js";function me({auth:_,users:f,filters:j,offices:r=[]}){const[B,u]=c.useState(!1),[o,b]=c.useState(!1),[M,v]=c.useState(null),[m,S]=c.useState(j.search||""),{data:s,setData:t,post:L,put:A,processing:h,errors:i,reset:k,clearErrors:N}=z({name:"",email:"",password:"",role:"bendahara",office_id:1,is_active:!0,allowed_panels:[]});c.useEffect(()=>{const a=setTimeout(()=>{m!==(j.search||"")&&y.get(route("superadmin.users.index"),{search:m},{preserveState:!0,replace:!0})},300);return()=>clearTimeout(a)},[m]);const U=()=>{b(!1),v(null),k(),N(),u(!0)},E=a=>{b(!0),v(a),t({name:a.name,email:a.email,password:"",role:a.role,office_id:a.office_id,allowed_panels:a.allowed_panels||[],is_active:!!a.is_active}),N(),u(!0)},x=()=>{u(!1),k()},T=a=>{a.preventDefault(),o?A(route("superadmin.users.update",M.id),{onSuccess:()=>x()}):L(route("superadmin.users.store"),{onSuccess:()=>x()})},P=a=>{if(a.id===_.user.id){p.fire({icon:"error",title:"Opps!",text:"Anda tidak bisa menghapus akun sendiri."});return}p.fire({title:"Hapus User?",text:`Apakah Anda yakin ingin menghapus ${a.name}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"}).then(d=>{d.isConfirmed&&y.delete(route("superadmin.users.destroy",a.id),{onSuccess:()=>{p.fire({icon:"success",title:"Terhapus!",text:"User berhasil dihapus.",timer:1500,showConfirmButton:!1})}})})},I=[{key:"name",label:"Nama",render:a=>e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-gray-900",children:a.name}),e.jsxs("div",{className:"text-xs text-gray-400 font-medium",children:["UID: ",a.id]})]})},{key:"email",label:"Email",render:a=>e.jsx("span",{className:"text-sm text-gray-600 font-medium",children:a.email})},{key:"role",label:"Role",render:a=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(C,{variant:a.role==="superadmin"?"purple":"indigo",size:"md",children:a.role}),e.jsx("span",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest pl-0.5",children:r.find(d=>d.id===a.office_id)?.name||"N/A"})]})},{key:"status",label:"Status",render:a=>e.jsx(C,{variant:a.is_active?"emerald":"red",size:"md",dot:!0,children:a.is_active?"Aktif":"Nonaktif"})},{key:"actions",label:"Aksi",align:"right",render:a=>e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx("button",{onClick:()=>E(a),className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Edit User",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>P(a),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Hapus User",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})}];return r.length===0&&[1,2,3,4,5].map(a=>({id:`mock-${a}`,name:"",email:"",role:"",is_active:!1})),e.jsxs(W,{children:[e.jsx(F,{title:"Management User"}),e.jsxs("div",{className:"py-12 relative min-h-[500px]",children:[r.length===0&&e.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-6",children:[e.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-md"}),e.jsxs("div",{className:"relative z-50 bg-white p-8 rounded-2xl shadow-2xl border border-gray-100 max-w-md w-full text-center animate-fade-in-up",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 text-red-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("h3",{className:"text-xl font-black text-gray-900 mb-2",children:"Akses Dibatasi"}),e.jsxs("p",{className:"text-gray-500 mb-6 font-medium",children:["Halaman ini hanya dapat diakses oleh ",e.jsx("span",{className:"text-indigo-600 font-bold",children:"Superadmin Kantor Utama"}),"."]}),e.jsx("div",{className:"mt-6",children:e.jsxs($,{href:route("projectexpense.overview"),className:"inline-flex items-center justify-center px-5 py-2.5 text-sm font-bold rounded-lg text-white bg-gray-900 hover:bg-gray-800 transition-all shadow-sm",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Kembali ke Dashboard"]})})]})]}),e.jsx("div",{className:`max-w-7xl mx-auto sm:px-6 lg:px-8 transition-all duration-500 ${r.length===0?"blur-sm opacity-50 pointer-events-none select-none grayscale":""}`,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{title:"Management User",actions:e.jsx(w,{onClick:U,children:"+ Tambah User"})}),e.jsx(q,{value:m,onChange:S,placeholder:"Cari nama atau email...",maxWidth:"max-w-sm"}),e.jsx(Y,{columns:I,data:r.length===0?[]:f.data,emptyMessage:"Tidak ada data user.",pagination:r.length>0?f.links:null})]})})]}),e.jsx(O,{show:B,onClose:x,children:e.jsxs("form",{onSubmit:T,className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:o?"Edit User":"Tambah User Baru"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"name",value:"Nama Lengkap"}),e.jsx(g,{id:"name",type:"text",className:"mt-1 block w-full",value:s.name,onChange:a=>t("name",a.target.value),required:!0,isFocused:!0}),e.jsx(l,{message:i.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"email",value:"Email"}),e.jsx(g,{id:"email",type:"email",className:"mt-1 block w-full",value:s.email,onChange:a=>t("email",a.target.value),required:!0}),e.jsx(l,{message:i.email,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"password",value:"Password"}),e.jsx(g,{id:"password",type:"password",className:"mt-1 block w-full",value:s.password,onChange:a=>t("password",a.target.value),placeholder:o?"Isi jika ingin mengubah":"",required:!o}),e.jsx(l,{message:i.password,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{value:"Pilih Role Akses",className:"mb-2"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{id:"superadmin",name:"Superadmin",desc:"Akses penuh seluruh kantor & switcher",icon:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04M12 21.499V21.5a11.955 11.955 0 01-8.618-3.04"},{id:"bendahara",name:"Bendahara",desc:"Akses modul Finance & Piutang",icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}].map(a=>e.jsxs("button",{type:"button",onClick:()=>t("role",a.id),className:`flex flex-col p-3 rounded-xl border-2 text-left transition-all ${s.role===a.id?"border-indigo-600 bg-indigo-50/50 shadow-sm":"border-gray-100 hover:border-indigo-200 bg-white"}`,children:[e.jsx("div",{className:`p-1.5 rounded-lg w-fit mb-2 ${s.role===a.id?"bg-indigo-600 text-white":"bg-gray-100 text-gray-500"}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:a.icon})})}),e.jsx("span",{className:`text-[11px] font-black uppercase tracking-wider ${s.role===a.id?"text-indigo-700":"text-gray-900"}`,children:a.name}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1 leading-tight font-medium",children:a.desc})]},a.id))}),e.jsx(l,{message:i.role,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{value:"Penempatan Kantor",className:"mb-2"}),e.jsx("div",{className:"flex p-1 bg-gray-100 rounded-xl border border-gray-200",children:r.map(a=>e.jsx("button",{type:"button",onClick:()=>t("office_id",a.id),className:`flex-1 py-2 text-center rounded-lg text-xs font-black uppercase tracking-widest transition-all ${s.office_id===a.id?"bg-white text-indigo-600 shadow-sm":"text-gray-400 hover:text-gray-600"}`,children:a.name},a.id))}),e.jsx(l,{message:i.office_id,className:"mt-2"})]}),s.role==="bendahara"&&e.jsxs("div",{children:[e.jsx(n,{value:"Akses Panel",className:"mb-2"}),e.jsx("div",{className:"flex flex-col gap-2",children:[{id:"finance",label:"Finance (Biaya Proyek & Operasional)"},{id:"plant_cash",label:"Plant Cash (Kas Besar & Kecil)"},{id:"receivable",label:"Receivable (Piutang)"}].map(a=>e.jsxs("label",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:[e.jsx(R,{name:"allowed_panels",value:a.id,checked:s.allowed_panels.includes(a.id),onChange:d=>{const D=d.target.checked;t("allowed_panels",D?[...s.allowed_panels,a.id]:s.allowed_panels.filter(H=>H!==a.id))}}),e.jsx("span",{className:"text-gray-700 text-sm font-medium",children:a.label})]},a.id))}),e.jsx(l,{message:i.allowed_panels,className:"mt-2"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:s.is_active,onChange:a=>t("is_active",a.target.checked)}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"}),e.jsx("span",{className:"ml-3 text-sm font-medium text-gray-900",children:"Status Aktif"})]})}),e.jsx(l,{message:i.is_active,className:"mt-2"})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx(K,{onClick:x,disabled:h,children:"Batal"}),e.jsx(w,{disabled:h,children:h?"Menyimpan...":o?"Simpan Data":"Buat User"})]})]})})]})}export{me as default};
