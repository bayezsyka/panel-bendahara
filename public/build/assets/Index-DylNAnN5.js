import{r as c,u as z,j as e,H as E,L as v}from"./app-DM7Ryi-z.js";import{B as I}from"./BendaharaLayout-Da4CtD9_.js";import{P as D}from"./PageHeader-DSX_eEFn.js";import{M as W}from"./Modal-CTWfF6TH.js";import{I as t}from"./InputLabel-vbWpQYMs.js";import{T as h}from"./TextInput-CWs23yt5.js";import{P as T}from"./PrimaryButton-BR6Njwm2.js";import{S as H}from"./SecondaryButton-B0qsIGyj.js";import{I as l}from"./InputError-D4Wa1fdP.js";/* empty css            */import"./ApplicationLogo-BdmSE6u6.js";import"./transition-kgKajmGQ.js";import"./with-selector-ySbjpWVy.js";function Y({projects:j,mandors:y,benderas:N}){const[w,i]=c.useState(!1),[m,g]=c.useState(!1),[p,b]=c.useState(null),[u,L]=c.useState(""),f=j.filter(s=>{const a=u.toLowerCase();return s.name.toLowerCase().includes(a)||s.description&&s.description.toLowerCase().includes(a)||s.location&&s.location.toLowerCase().includes(a)||s.bendera&&s.bendera.name.toLowerCase().includes(a)||s.mandors&&s.mandors.some(n=>n.name.toLowerCase().includes(a))}),{data:r,setData:o,post:C,put:P,processing:_,errors:d,reset:x,clearErrors:k}=z({name:"",description:"",status:"ongoing",coordinates:"",mandor_id:"",mandor_ids:[],bendera_id:"",location:""}),B=()=>{g(!1),b(null),x(),k(),i(!0)},S=s=>{g(!0),b(s);const a=s.mandors?s.mandors.map(n=>n.id):s.mandor_id?[s.mandor_id]:[];o({name:s.name,description:s.description||"",status:s.status,coordinates:s.coordinates||"",mandor_id:s.mandor_id||"",mandor_ids:a,bendera_id:s.bendera_id||"",location:s.location||""}),k(),i(!0)},M=s=>{if(s.preventDefault(),m){const a=p.slug||p.id;P(route("bendahara.projects.update",a),{onSuccess:()=>{i(!1),x()}})}else C(route("bendahara.projects.store"),{onSuccess:()=>{i(!1),x()}})};return e.jsxs(I,{children:[e.jsx(E,{title:"Proyek Konstruksi"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(D,{title:"Proyek Konstruksi",backLink:route("bendahara.dashboard"),backLabel:"Dashboard",actions:e.jsxs("button",{onClick:B,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 transition shadow-sm",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Buat Proyek"]})}),e.jsxs("div",{className:"relative max-w-md",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-200 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition duration-150 ease-in-out shadow-sm",placeholder:"Cari proyek berdasar nama, lokasi, bendera, atau pelaksana...",value:u,onChange:s=>L(s.target.value)})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.length>0?f.map(s=>e.jsxs("div",{className:"group flex flex-col bg-white border border-gray-200 rounded-xl hover:border-indigo-300 hover:shadow-md transition duration-200 overflow-hidden",children:[e.jsxs(v,{href:route("bendahara.projects.show",s.slug||s.id),className:"flex-1 p-5 block",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:`px-2.5 py-1 rounded-full text-xs font-semibold ${s.status==="ongoing"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:s.status==="ongoing"?"Berjalan":"Selesai"}),e.jsx("span",{className:"text-xs text-gray-400",children:new Date(s.created_at).toLocaleDateString("id-ID")})]}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-1 group-hover:text-indigo-600 transition",children:s.name}),s.bendera&&e.jsxs("div",{className:"mb-3 inline-block px-2 py-0.5 rounded text-[10px] font-bold tracking-wide uppercase bg-purple-100 text-purple-700",children:["ðŸ¢ ",s.bendera.name]}),e.jsxs("div",{className:"space-y-2 mb-2",children:[s.mandors&&s.mandors.length>0?e.jsx("div",{className:"space-y-1.5",children:s.mandors.map((a,n)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 bg-gray-50 px-2 py-1.5 rounded border border-gray-100",children:[e.jsx("svg",{className:"w-3.5 h-3.5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),e.jsxs("span",{className:"font-medium",children:["Pelaksana ",n+1,": ",a.name]})]},a.id))}):s.mandor&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 bg-gray-50 px-2 py-1.5 rounded border border-gray-100",children:[e.jsx("svg",{className:"w-3.5 h-3.5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),e.jsxs("span",{className:"font-medium",children:["Pelaksana: ",s.mandor.name]})]}),(s.location||s.coordinates)&&e.jsxs("div",{className:"flex items-start gap-2 text-xs text-gray-500 px-2",children:[e.jsxs("svg",{className:"w-3.5 h-3.5 text-gray-400 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{className:"line-clamp-1",children:s.location||"Lokasi Koordinat Tersedia"})]})]}),e.jsx("p",{className:"text-sm text-gray-500 line-clamp-2 mt-3 pt-3 border-t border-dashed border-gray-100",children:s.description||"Tidak ada deskripsi."})]}),e.jsxs("div",{className:"bg-gray-50 px-5 py-3 border-t border-gray-100 flex justify-between items-center",children:[e.jsx(v,{href:route("bendahara.projects.show",s.slug||s.id),className:"text-xs font-medium text-gray-600 hover:text-indigo-600",children:"Lihat Detail"}),e.jsxs("button",{onClick:()=>S(s),className:"text-xs font-medium text-indigo-600 hover:text-indigo-800 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit Proyek"]})]})]},s.id)):e.jsxs("div",{className:"col-span-full py-12 flex flex-col items-center justify-center bg-white rounded-xl border border-gray-200",children:[e.jsx("svg",{className:"w-12 h-12 text-gray-300 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsxs("p",{className:"text-gray-500 font-medium",children:['Tidak ada proyek yang cocok dengan "',u,'"']})]})})]}),e.jsx(W,{show:w,onClose:()=>i(!1),children:e.jsxs("form",{onSubmit:M,className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:m?"Edit Proyek":"Buat Proyek Baru"}),e.jsxs("div",{className:"mb-4",children:[e.jsx(t,{value:"Nama Proyek"}),e.jsx(h,{value:r.name,onChange:s=>o("name",s.target.value),className:"mt-1 block w-full",placeholder:"Contoh: Renovasi Gedung A",autoFocus:!0,required:!0}),e.jsx(l,{message:d.name,className:"mt-2"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:e.jsxs("div",{children:[e.jsx(t,{value:"Bendera (PT/CV)"}),e.jsxs("select",{value:r.bendera_id,onChange:s=>o("bendera_id",s.target.value),className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",children:[e.jsx("option",{value:"",children:"-- Pilih Bendera --"}),N.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx(l,{message:d.bendera_id,className:"mt-2"})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx(t,{value:"Pelaksana (Bisa Pilih Lebih dari 1)"}),e.jsx("div",{className:"mt-1 border border-gray-300 rounded-md p-2 max-h-32 overflow-y-auto bg-gray-50",children:y.map(s=>e.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-100 rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.mandor_ids.includes(s.id),onChange:a=>{a.target.checked?o("mandor_ids",[...r.mandor_ids,s.id]):o("mandor_ids",r.mandor_ids.filter(n=>n!==s.id))},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsxs("span",{className:"text-sm text-gray-700",children:[s.name," (",s.whatsapp_number,")"]})]},s.id))}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Pilih satu atau lebih pelaksana untuk proyek ini"}),e.jsx(l,{message:d.mandor_ids,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(t,{value:"Lokasi Proyek (Teks)"}),e.jsx(h,{value:r.location,onChange:s=>o("location",s.target.value),className:"mt-1 block w-full",placeholder:"Contoh: Jl. Sudirman No. 45, Jakarta"}),e.jsx(l,{message:d.location,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(t,{value:"Koordinat Maps (Opsional)"}),e.jsx(h,{value:r.coordinates,onChange:s=>o("coordinates",s.target.value),className:"mt-1 block w-full",placeholder:"Contoh: -6.1234, 106.1234"}),e.jsx(l,{message:d.coordinates,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(t,{value:"Deskripsi (Opsional)"}),e.jsx("textarea",{value:r.description,onChange:s=>o("description",s.target.value),className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",rows:"2",placeholder:"Catatan tambahan..."})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(t,{value:"Status Proyek"}),e.jsxs("select",{value:r.status,onChange:s=>o("status",s.target.value),className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",children:[e.jsx("option",{value:"ongoing",children:"Sedang Berjalan"}),e.jsx("option",{value:"completed",children:"Selesai (Completed)"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(H,{onClick:()=>i(!1),children:"Batal"}),e.jsx(T,{disabled:_,children:m?"Simpan Perubahan":"Buat Proyek"})]})]})})]})}export{Y as default};
